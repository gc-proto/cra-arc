<!DOCTYPE html>
<html class="no-js" dir="ltr" lang="en">
<head>
<meta charset="utf-8"/>
<title>Personal tax credits returns (Form TD1) - Calculate payroll deductions and contributions - Canada.ca</title>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://www.canada.ca/etc/designs/canada/wet-boew/css/theme.min.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" rel="stylesheet"/>
<style>
  body { font-family: Arial, sans-serif; margin: 40px; max-width: 700px; }
  label { display: block; margin-top: 15px; }
  input[type="number"], select { width: 100%; padding: 8px; margin-top: 5px; }
  button { margin-top: 20px; padding: 10px 15px; }
  .result { margin-top: 30px; padding: 15px; background-color: #f4f4f4; border-left: 4px solid #0078D4; }
  .hidden { display: none; }
  #calculator { display: flex; gap: 20px; flex-wrap: wrap; }
  #calculator li { flex: 1 1 45%; list-style: none; }
  #calculator li.full-width { flex: 1 1 100%; }
</style>
</head>
<body>
<h1>Calculate income tax deductions using formulas</h1>

<fieldset>
  <legend>Do you have a federal Form TD1 on file for this employee?</legend>
  <ul>
    <li><input id="q1-true" name="td1" type="radio" onclick="toggleTD1(true)"><label for="q1-true">Yes</label></li>
    <li><input id="q1-false" name="td1" type="radio" onclick="toggleTD1(false)"><label for="q1-false">No</label></li>
  </ul>
</fieldset>

<fieldset class="hidden" id="provincialTD1Question">
  <legend>Do you also have a provincial Form TD1 on file for this employee?</legend>
  <ul>
    <li><input id="q2-true" name="provincial_td1" type="radio" onclick="toggleProvTD1(true)"><label for="q2-true">Yes</label></li>
    <li><input id="q2-false" name="provincial_td1" type="radio" onclick="toggleProvTD1(false)"><label for="q2-false">No</label></li>
  </ul>
</fieldset>

<section class="alert alert-warning hidden" id="noMessage">
  <p>You <strong>cannot</strong> use the calculation formula if you <strong>do not have a Form TD1 on file</strong>.</p>
</section>

<div class="hidden" id="provinceSection">
  <label for="province">Select the province or territory</label>
  <select id="province" onchange="handleProvince()">
    <option value="">-- Make your selection --</option>
    <option value="Alberta">Alberta</option>
    <option value="British Columbia">British Columbia</option>
    <option value="Manitoba">Manitoba</option>
    <option value="New Brunswick">New Brunswick</option>
    <option value="Newfoundland and Labrador">Newfoundland and Labrador</option>
    <option value="Nova Scotia">Nova Scotia</option>
    <option value="Ontario">Ontario</option>
    <option value="Prince Edward Island">Prince Edward Island</option>
    <option value="Quebec">Quebec</option>
    <option value="Saskatchewan">Saskatchewan</option>
    <option value="Northwest Territories">Northwest Territories</option>
    <option value="Nunavut">Nunavut</option>
    <option value="Yukon">Yukon</option>
  </select>
</div>

<div class="hidden" id="yearSection">
  <label for="year">Select the calendar year</label>
  <select id="year" onchange="showCalculators()">
    <option value="">-- Make your selection --</option>
    <option value="2025">2025</option>
    <option value="2024">2024</option>
    <option value="2023">2023</option>
  </select>
</div>

<ul class="hidden" id="calculator">
  <!-- Federal TD1 -->
  <li id="liFederal">
    <section>
      <p><strong>Federal Form TD1</strong></p>
      <label for="line1">Line 1 (total claim)</label><input id="line1" type="number">
      <div id="line2Section"><label for="line2">Line 2 (Nova Scotia only)</label><input id="line2" type="number"></div>
      <div id="line3Section"><label for="line3">Line 3 (pension/tuition)</label><input id="line3" type="number"></div>
      <button onclick="calculateTCP()" disabled>Calculate Federal</button>
      <div class="result" id="result"></div>
    </section>
  </li>
  <!-- Provincial TD1 -->
  <li id="liProv">
    <section>
      <p><strong>Provincial Form TD1</strong></p>
      <label for="line1prov">Line 1 (total claim)</label><input id="line1prov" type="number">
      <div id="line2Sectionprov"><label for="line2prov">Line 2 (Nova Scotia only)</label><input id="line2prov" type="number"></div>
      <div id="line3Sectionprov"><label for="line3prov">Line 3 (pension/tuition)</label><input id="line3prov" type="number"></div>
      <button onclick="calculateTCPprov()" disabled>Calculate Provincial</button>
      <div class="result" id="resultprov"></div>
    </section>
  </li>
</ul>

<script>
let hasProvincialTD1 = false;
let hasFederalTD1 = false;

function toggleTD1(hasTD1){
  hasFederalTD1 = hasTD1;
  document.getElementById('provincialTD1Question').classList.toggle('hidden', !hasTD1);
  document.getElementById('noMessage').classList.toggle('hidden', hasTD1);
  document.getElementById('calculator').classList.add('hidden');
  if(!hasTD1){
    document.getElementById('provinceSection').classList.add('hidden');
    document.getElementById('yearSection').classList.add('hidden');
    hasProvincialTD1 = false;
    document.getElementById('liProv').classList.add('hidden');
    document.getElementById('liFederal').classList.add('hidden');
  }
}

function toggleProvTD1(hasProv){
  hasProvincialTD1 = hasProv;
  document.getElementById('provinceSection').classList.remove('hidden');
  document.getElementById('yearSection').classList.remove('hidden');
  document.getElementById('liProv').classList.toggle('hidden', !hasProv);
  showCalculators();
}

function handleProvince(){
  const province = document.getElementById('province').value;
  if(province==='Prince Edward Island'){
    alert('No indexing applies to PEI. Calculator not applicable.');
    document.getElementById('yearSection').classList.add('hidden');
  }else{
    document.getElementById('yearSection').classList.remove('hidden');
  }
  showCalculators();
}

function showCalculators(){
  const year = document.getElementById('year').value;
  const liFederal = document.getElementById('liFederal');
  const liProv = document.getElementById('liProv');
  
  if(hasFederalTD1){
    liFederal.classList.remove('hidden');
    liFederal.classList.remove('full-width');
  } else {
    liFederal.classList.add('hidden');
  }

  if(hasProvincialTD1){
    liProv.classList.remove('hidden');
    // Full-width if no federal TD1
    if(!hasFederalTD1){
      liProv.classList.add('full-width');
    } else {
      liProv.classList.remove('full-width');
    }
  } else {
    liProv.classList.add('hidden');
  }

  // Show the container only if any calculator visible
  document.getElementById('calculator').classList.toggle('hidden', !hasFederalTD1 && !hasProvincialTD1);
}

function calculateTCP(){
  const line1 = parseFloat(document.getElementById('line1').value)||0;
  document.getElementById('result').innerHTML = `<p>Federal calculation result: $${line1.toFixed(2)}</p>`;
}

function calculateTCPprov(){
  const line1prov = parseFloat(document.getElementById('line1prov').value)||0;
  document.getElementById('resultprov').innerHTML = `<p>Provincial calculation result: $${line1prov.toFixed(2)}</p>`;
}
</script>
</body>
</html>
